# Atividade 1


## (a)

### `$ ping www.ic.unicamp.br -c 10`

```
PING atibaia.ic.unicamp.br (143.106.7.54) 56(84) bytes of data.
64 bytes from atibaia.ic.unicamp.br (143.106.7.54): icmp_seq=1 ttl=63 time=0.267 ms
64 bytes from atibaia.ic.unicamp.br (143.106.7.54): icmp_seq=2 ttl=63 time=0.419 ms
64 bytes from atibaia.ic.unicamp.br (143.106.7.54): icmp_seq=3 ttl=63 time=0.231 ms
64 bytes from atibaia.ic.unicamp.br (143.106.7.54): icmp_seq=4 ttl=63 time=0.311 ms
64 bytes from atibaia.ic.unicamp.br (143.106.7.54): icmp_seq=5 ttl=63 time=0.366 ms
64 bytes from atibaia.ic.unicamp.br (143.106.7.54): icmp_seq=6 ttl=63 time=0.483 ms
64 bytes from atibaia.ic.unicamp.br (143.106.7.54): icmp_seq=7 ttl=63 time=0.354 ms
64 bytes from atibaia.ic.unicamp.br (143.106.7.54): icmp_seq=8 ttl=63 time=0.382 ms
64 bytes from atibaia.ic.unicamp.br (143.106.7.54): icmp_seq=9 ttl=63 time=0.300 ms
64 bytes from atibaia.ic.unicamp.br (143.106.7.54): icmp_seq=10 ttl=63 time=0.299 ms

--- atibaia.ic.unicamp.br ping statistics ---
10 packets transmitted, 10 received, 0% packet loss, time 9244ms
rtt min/avg/max/mdev = 0.231/0.341/0.483/0.072 ms
```

### `$ ping www.unesp.br -c 10`

```
PING yoda.unesp.br (200.145.6.90) 56(84) bytes of data.
64 bytes from yoda.unesp.br (200.145.6.90): icmp_seq=1 ttl=59 time=3.26 ms
64 bytes from yoda.unesp.br (200.145.6.90): icmp_seq=2 ttl=59 time=3.32 ms
64 bytes from yoda.unesp.br (200.145.6.90): icmp_seq=3 ttl=59 time=3.33 ms
64 bytes from yoda.unesp.br (200.145.6.90): icmp_seq=4 ttl=59 time=3.42 ms
64 bytes from yoda.unesp.br (200.145.6.90): icmp_seq=5 ttl=59 time=3.33 ms
64 bytes from yoda.unesp.br (200.145.6.90): icmp_seq=6 ttl=59 time=3.38 ms
64 bytes from yoda.unesp.br (200.145.6.90): icmp_seq=7 ttl=59 time=3.41 ms
64 bytes from yoda.unesp.br (200.145.6.90): icmp_seq=8 ttl=59 time=3.41 ms
64 bytes from yoda.unesp.br (200.145.6.90): icmp_seq=9 ttl=59 time=3.34 ms
64 bytes from yoda.unesp.br (200.145.6.90): icmp_seq=10 ttl=59 time=3.53 ms

--- yoda.unesp.br ping statistics ---
10 packets transmitted, 10 received, 0% packet loss, time 9013ms
rtt min/avg/max/mdev = 3.261/3.374/3.532/0.091 ms
```

### `$ ping www.usp.br -c 10`

```
PING rubus.uspnet.usp.br (200.144.248.41) 56(84) bytes of data.
64 bytes from webhost.uspdigital.usp.br (200.144.248.41): icmp_seq=1 ttl=249 time=3.38 ms
64 bytes from webhost.uspdigital.usp.br (200.144.248.41): icmp_seq=2 ttl=249 time=3.58 ms
64 bytes from webhost.uspdigital.usp.br (200.144.248.41): icmp_seq=3 ttl=249 time=3.65 ms
64 bytes from webhost.uspdigital.usp.br (200.144.248.41): icmp_seq=4 ttl=249 time=3.50 ms
64 bytes from webhost.uspdigital.usp.br (200.144.248.41): icmp_seq=5 ttl=249 time=3.52 ms
64 bytes from webhost.uspdigital.usp.br (200.144.248.41): icmp_seq=6 ttl=249 time=3.53 ms
64 bytes from webhost.uspdigital.usp.br (200.144.248.41): icmp_seq=7 ttl=249 time=3.47 ms
64 bytes from webhost.uspdigital.usp.br (200.144.248.41): icmp_seq=8 ttl=249 time=3.49 ms
64 bytes from webhost.uspdigital.usp.br (200.144.248.41): icmp_seq=9 ttl=249 time=3.42 ms
64 bytes from webhost.uspdigital.usp.br (200.144.248.41): icmp_seq=10 ttl=249 time=3.64 ms

--- rubus.uspnet.usp.br ping statistics ---
10 packets transmitted, 10 received, 0% packet loss, time 9014ms
rtt min/avg/max/mdev = 3.385/3.522/3.653/0.098 ms
```

### `$ ping www.cs.man.ac.uk -c 10`

```
PING waldorf.cs.man.ac.uk (130.88.199.17) 56(84) bytes of data.
64 bytes from waldorf.cs.man.ac.uk (130.88.199.17): icmp_seq=1 ttl=46 time=219 ms
64 bytes from waldorf.cs.man.ac.uk (130.88.199.17): icmp_seq=2 ttl=46 time=219 ms
64 bytes from waldorf.cs.man.ac.uk (130.88.199.17): icmp_seq=3 ttl=46 time=219 ms
64 bytes from waldorf.cs.man.ac.uk (130.88.199.17): icmp_seq=4 ttl=46 time=219 ms
64 bytes from waldorf.cs.man.ac.uk (130.88.199.17): icmp_seq=5 ttl=46 time=219 ms
64 bytes from waldorf.cs.man.ac.uk (130.88.199.17): icmp_seq=6 ttl=46 time=219 ms
64 bytes from waldorf.cs.man.ac.uk (130.88.199.17): icmp_seq=7 ttl=46 time=219 ms
64 bytes from waldorf.cs.man.ac.uk (130.88.199.17): icmp_seq=8 ttl=46 time=219 ms
64 bytes from waldorf.cs.man.ac.uk (130.88.199.17): icmp_seq=9 ttl=46 time=219 ms
64 bytes from waldorf.cs.man.ac.uk (130.88.199.17): icmp_seq=10 ttl=46 time=219 ms

--- waldorf.cs.man.ac.uk ping statistics ---
10 packets transmitted, 10 received, 0% packet loss, time 9013ms
rtt min/avg/max/mdev = 219.633/219.704/219.788/0.594 ms
```

### `$ ping www.u-tokyo.ac.jp -c 10`

```
PING www.u-tokyo.ac.jp (210.152.135.178) 56(84) bytes of data.
64 bytes from 210.152.135.178 (210.152.135.178): icmp_seq=1 ttl=42 time=310 ms
64 bytes from 210.152.135.178 (210.152.135.178): icmp_seq=2 ttl=42 time=310 ms
64 bytes from 210.152.135.178 (210.152.135.178): icmp_seq=3 ttl=42 time=310 ms
64 bytes from 210.152.135.178 (210.152.135.178): icmp_seq=4 ttl=42 time=310 ms
64 bytes from 210.152.135.178 (210.152.135.178): icmp_seq=5 ttl=42 time=310 ms
64 bytes from 210.152.135.178 (210.152.135.178): icmp_seq=6 ttl=42 time=310 ms
64 bytes from 210.152.135.178 (210.152.135.178): icmp_seq=7 ttl=42 time=310 ms
64 bytes from 210.152.135.178 (210.152.135.178): icmp_seq=8 ttl=42 time=310 ms
64 bytes from 210.152.135.178 (210.152.135.178): icmp_seq=9 ttl=42 time=310 ms
64 bytes from 210.152.135.178 (210.152.135.178): icmp_seq=10 ttl=42 time=310 ms

--- www.u-tokyo.ac.jp ping statistics ---
10 packets transmitted, 10 received, 0% packet loss, time 9009ms
rtt min/avg/max/mdev = 310.157/310.329/310.726/0.639 ms
```

A principal informação que podemos tirar da saída do `$ ping` são os valores de RTT (Round-Trip Time) para os diferentes servidores. RTT é o tempo necessário para um pacote sair do host (nosso computador), ir ao servidor e retornar. Sendo assim, para servidores mais próximos do host o RTT deve ser menor, e para servidores mais distantes deve ser maior.

Isso pode ser visto facilmente nos resultados acima, pois a lista de pings é listada em ordem crescente de distância do host para o servidor, e analisando o RTT médio, é possível ver que os RTT's aumentam

## (b) TERMINAR DE EXPLICAR PORQUE O SITE NÃO É ALCANÇÁVEL PELO PING

### `$ ping www.lrc.ic.unicamp.br -c 5 `

```
PING lrc-gw.ic.unicamp.br (143.106.7.163) 56(84) bytes of data.

--- lrc-gw.ic.unicamp.br ping statistics ---
5 packets transmitted, 0 received, 100% packet loss, time 4096ms
```

Podemos ver que o servidor em questão ignora os pacotes enviados pelo `ping`, de forma que nosso host não obtém os pacotes de resposta.


## (c) ALTERAR NUMERO DE PACOTES ENVIADOS e RECEBIDOS PELA INTERFACE LOOPBACK

### Input:
```
netdev=$(ifconfig | grep UP,BROADCAST,RUNNING,MULTICAST | awk '{print $1}')
netdev=${netdev::-1}

loopdev=$(ifconfig | grep LOOPBACK | awk '{print $1}')
loopdev=${loopdev::-1}

printf "Local IP: "
ifconfig $netdev | grep "inet " | awk '{print $2}'

printf "Public IP: "
curl ipinfo.io/ip

printf "Interface de rede: $netdev\n"

printf "Interface de loopback: $loopdev"
```

### Output:
```
Local IP: 143.106.16.163
Public IP: 143.106.16.163
Interface de rede: enp2s0
Interface de loopback: lo
```

Os IP locais e públicos no caso em questão (PC do IC) são o mesmo pois a máquina não está ligada a rede através de um roteador.


## (d)

### Input:
```
printf "Default Gateway: "
route -n | grep UG | awk '{print $2}'
```

### Output:
```
Default Gateway: 143.106.16.148
```

## (e)

### Input:
```
printf "DNS Server: "
nmcli dev show | grep DNS | awk '{print $2}'

declare -a sites=("www.ic.unicamp.br" "www.unicamp.br" "www.usp.br" "www.unesp.br" "www.cs.man.ac.uk" "www.u-tokyo.ac.jp")

for i in "${sites[@]}"
do
    printf "$i: "
    nslookup $i | grep Address | awk '{l++}l==2' | awk '{print $2}'
done
```

### Output:
```
DNS Server: 143.106.7.31
www.ic.unicamp.br: 143.106.7.54
www.unicamp.br: 143.106.10.174
www.usp.br: 200.144.248.41
www.unesp.br: 200.145.6.90
www.cs.man.ac.uk: 130.88.199.17
www.u-tokyo.ac.jp: 210.152.135.178
```

## (f)

O comando `$ traceroute` envia, para cada roteador, três pacotes, registrando assim três RTT's. Podemos avaliar, para servidores fora do país, que ocorre a passagem por um enlace muito "longo" (atravessando continentes) quanto ocorre um salto muito grande entre o RTT de dois roteadores consecutivos. Poderemos avaliar isso para os dois últimos servidores.

### `$ traceroute www.ic.unicamp.br`:
```
traceroute to www.ic.unicamp.br (143.106.7.54), 30 hops max, 60 byte packets
 1  143.106.16.190 (143.106.16.190)  0.404 ms  0.586 ms  0.781 ms
 2  atibaia.ic.unicamp.br (143.106.7.54)  0.353 ms  0.353 ms  0.349 ms
```

### `$ traceroute www.unicamp.br`:
```
traceroute to www.unicamp.br (143.106.10.174), 30 hops max, 60 byte packets
 1  143.106.16.190 (143.106.16.190)  0.321 ms  0.446 ms  0.647 ms
 2  quake.lab.ic.unicamp.br (143.106.16.189)  0.379 ms  0.548 ms  0.749 ms
 3  area3-gw.unicamp.br (143.106.1.129)  0.463 ms  0.556 ms  0.702 ms
 4  * * *
 5  dmz-gw.unicamp.br (143.106.2.52)  0.420 ms  0.416 ms  0.471 ms
 6  cerejeira.unicamp.br (143.106.10.174)  0.672 ms  0.410 ms  0.589 ms
```

### `$ traceroute www.usp.br`:
```
traceroute to www.usp.br (200.144.248.41), 30 hops max, 60 byte packets
 1  * * *
 2  quake.lab.ic.unicamp.br (143.106.16.189)  0.345 ms  0.479 ms  0.684 ms
 3  area3-gw.unicamp.br (143.106.1.129)  0.385 ms  0.535 ms  0.633 ms
 4  * * ptp-nct-nbs.unicamp.br (143.106.199.13)  7.874 ms
 5  as28571.saopaulo.sp.ix.br (187.16.216.20)  2.449 ms  2.905 ms  2.432 ms
 6  border2.uspnet.usp.br (143.107.151.42)  2.857 ms  2.885 ms  3.383 ms
 7  143.107.249.38 (143.107.249.38)  3.481 ms  3.507 ms  3.973 ms
```

### `$ traceroute www.unesp.br`:
```
traceroute to www.unesp.br (200.145.6.90), 30 hops max, 60 byte packets
 1  143.106.16.190 (143.106.16.190)  0.389 ms  0.499 ms  0.735 ms
 2  quake.lab.ic.unicamp.br (143.106.16.189)  0.367 ms  0.494 ms  0.710 ms
 3  area3-gw.unicamp.br (143.106.1.129)  0.411 ms  0.606 ms  0.670 ms
 4  ptp-ncc-nbs.unicamp.br (143.106.199.9)  0.289 ms ptp-nct-nbs.unicamp.br (143.106.199.13)  1.917 ms ptp-ncc-nbs.unicamp.br (143.106.199.9)  0.333 ms
 5  * * *
 6  rt-asr.net.unesp.br (200.145.0.253)  2.927 ms  2.906 ms  3.432 ms
```

### `$ traceroute www.cs.man.ac.uk`:
```
traceroute to www.cs.man.ac.uk (130.88.199.17), 30 hops max, 60 byte packets
 1  143.106.16.190 (143.106.16.190)  0.478 ms  0.576 ms  0.792 ms
 2  quake.lab.ic.unicamp.br (143.106.16.189)  0.450 ms  0.604 ms  0.768 ms
 3  area3-gw.unicamp.br (143.106.1.129)  0.473 ms  0.672 ms  0.724 ms
 4  ptp-nct-nbs.unicamp.br (143.106.199.13)  0.386 ms  0.380 ms *
 5  * * *
 6  sp-sp2.bkb.rnp.br (200.143.253.37)  2.952 ms  2.420 ms  2.897 ms
 7  et-3-3-0.469.rtsw.wash.net.internet2.edu (64.57.28.61)  138.148 ms  138.154 ms  138.068 ms
 8  internet2.mx1.lon.uk.geant.net (62.40.124.44)  212.767 ms  212.862 ms  213.167 ms
 9  janet-gw.mx1.lon.uk.geant.net (62.40.124.198)  212.851 ms  212.845 ms  213.161 ms
10  ae29.londpg-sbr2.ja.net (146.97.33.2)  214.139 ms  213.668 ms  213.741 ms
11  ae31.erdiss-sbr2.ja.net (146.97.33.22)  216.995 ms  217.566 ms  217.558 ms
12  ae29.manckh-sbr1.ja.net (146.97.33.42)  219.044 ms  219.065 ms  219.028 ms
13  nnw.manckh-sbr1.ja.net (146.97.41.62)  219.772 ms  219.072 ms  219.192 ms
14  gw-man-kb2.netnw.net.uk (194.66.27.18)  219.600 ms  219.115 ms  219.120 ms
15  gw-uom-kb.its.manchester.ac.uk (194.66.26.102)  219.279 ms  219.629 ms  219.410 ms
16  130.88.249.185 (130.88.249.185)  220.173 ms  220.150 ms  220.047 ms
17  gw-jh.cnw.its.manchester.ac.uk (130.88.249.178)  220.326 ms  220.742 ms  219.926 ms
18  130.88.250.35 (130.88.250.35)  220.412 ms  220.021 ms  220.417 ms
19  gw-kilburn.its.manchester.ac.uk (192.84.75.10)  220.192 ms  220.181 ms  220.174 ms
20  waldorf.cs.man.ac.uk (130.88.199.17)  219.800 ms !X  219.778 ms !X  219.718 ms !X
```

É possível encontrar aqui dois grandes enlaces:

1.
```
6  sp-sp2.bkb.rnp.br (200.143.253.37)  2.952 ms  2.420 ms  2.897 ms
7  et-3-3-0.469.rtsw.wash.net.internet2.edu (64.57.28.61)  138.148 ms  138.154 ms  138.068 ms
```

2.
```
7  et-3-3-0.469.rtsw.wash.net.internet2.edu (64.57.28.61)  138.148 ms  138.154 ms  138.068 ms
8  internet2.mx1.lon.uk.geant.net (62.40.124.44)  212.767 ms  212.862 ms  213.167 ms
```

Percebe-se que existe entre cada dupla de roteador uma diferença de RTT de mais ou menos 100 ms, enquanto para os outros enlaces essa diferença não chega a ser maior do que 10 ms.

Isso pode ser comprovado verificando a localização destes roteadores (feito utilizando este [site](https://db-ip.com)):

```
6: Minas Gerais - Brazil
7: Michigan - USA
8: Cambridgeshire - England
```

### `$ traceroute www.u-tokyo.ac.jp`:
```
traceroute to www.u-tokyo.ac.jp (210.152.135.178), 30 hops max, 60 byte packets
 1  143.106.16.190 (143.106.16.190)  0.482 ms  0.581 ms  0.759 ms
 2  quake.lab.ic.unicamp.br (143.106.16.189)  0.752 ms  0.920 ms  1.071 ms
 3  area3-gw.unicamp.br (143.106.1.129)  0.456 ms  0.672 ms  0.704 ms
 4  ptp-nct-nbs.unicamp.br (143.106.199.13)  9.272 ms  9.275 ms  9.296 ms
 5  * * *
 6  sp-sp2.bkb.rnp.br (200.143.253.37)  3.334 ms  3.190 ms  2.710 ms
 7  mia2-sp-tws.bkb.rnp.br (200.143.252.22)  157.806 ms  157.363 ms mia2-sp-par-pac.bkb.rnp.br (200.143.252.34)  144.309 ms
 8  xe-0-0-26-2.a01.miamfl02.us.bb.gin.ntt.net (129.250.202.93)  109.700 ms  133.724 ms  109.724 ms
 9  ae-5.r05.miamfl02.us.bb.gin.ntt.net (129.250.3.166)  295.234 ms  271.452 ms  271.498 ms
10  ae-4.r21.miamfl02.us.bb.gin.ntt.net (129.250.3.172)  133.614 ms  157.468 ms  157.464 ms
11  ae-4.r22.dllstx09.us.bb.gin.ntt.net (129.250.2.219)  168.318 ms  168.274 ms  164.714 ms
12  ae-5.r22.lsanca07.us.bb.gin.ntt.net (129.250.7.69)  180.762 ms  181.542 ms  202.016 ms
13  ae-15.r25.osakjp02.jp.bb.gin.ntt.net (129.250.2.177)  273.757 ms  296.787 ms  274.883 ms
14  ae-24.r01.osakjp02.jp.bb.gin.ntt.net (129.250.5.49)  291.458 ms  283.500 ms  273.300 ms
15  xe-0-4-0-7.r01.osakjp02.jp.ce.gin.ntt.net (61.200.80.218)  305.491 ms  282.249 ms  281.022 ms
```

Aqui podemos ver dois principais grandes enlaces:

1.
```
6  sp-sp2.bkb.rnp.br (200.143.253.37)  3.334 ms  3.190 ms  2.710 ms
8  xe-0-0-26-2.a01.miamfl02.us.bb.gin.ntt.net (129.250.202.93)  109.700 ms  133.724 ms  109.724 ms
```

2.
```
8  xe-0-0-26-2.a01.miamfl02.us.bb.gin.ntt.net (129.250.202.93)  109.700 ms  133.724 ms  109.724 ms
9  ae-5.r05.miamfl02.us.bb.gin.ntt.net (129.250.3.166)  295.234 ms  271.452 ms  271.498 ms
```

Localização:
```
6: Minas Gerais - Brazil
8: Florida - USA
9: Hong Kong
```

Neste traceroute temos algumas discrepâncias como o caminho entre os roteadores 6 e 7, ambos muito próximos, mas com mais de 100 ms de diferença entre eles. Isso pode ser atribuído a algum problema no enlace que os une.

## (g)

As seguintes conexões TCP não foram obtidas em um computador do IC, mas em um computador pessoal. Isso foi feito pois os dados obtidos estavam sendo feito em uma máquina do IC utilizando ssh.

Utilizando o comando `$ netstat`:
```
tcp        0      0 192.168.0.105:33200     ce-in-f188.1e100.:https ESTABLISHED
tcp        0      0 192.168.0.105:50592     cb-in-f188.1e100.:https ESTABLISHED
tcp        0      0 192.168.0.105:50394     xaveco.lab.ic.unica:ssh ESTABLISHED
tcp        0      0 192.168.0.105:46422     stackoverflow.com:https ESTABLISHED
tcp        0      0 192.168.0.105:46494     stackoverflow.com:https ESTABLISHED
```

O endereço IP `192.168.0.105` é o endereço do host (endereço local) e os endereços à direita (ex:stackoverflow.com) são os endereços do servidor. Separados por ':', ao lado dos endereços do host tempos a porta de origem e ao lado dos endereços do servidor temos as portas de destino. Pode-se perceber que das 5 conexões, quatro são https (porta 443) e uma é a conexão ssh com o IC (porta 22).

Acessando o site `www.unicamp.br` é possível perceber que abrem-se várias novas conexões com o servidor do site (`cerejeira.unic`):

```
tcp        0      0 192.168.0.105:50094     cerejeira.unic:www-http ESTABLISHED
tcp        0      0 192.168.0.105:50086     cerejeira.unic:www-http ESTABLISHED
tcp        0      0 192.168.0.105:50088     cerejeira.unic:www-http ESTABLISHED
tcp        0      0 192.168.0.105:50084     cerejeira.unic:www-http ESTABLISHED
tcp        0      0 192.168.0.105:50090     cerejeira.unic:www-http ESTABLISHED
tcp        0      0 192.168.0.105:50092     cerejeira.unic:www-http ESTABLISHED
```

Podemos perceber que a conexão com o site é http (porta 80), ao contrário das mostradas anteriormente.

## (h) EXPLICAR O QUE ACONTECE QUANDO SE TENTA REALIZAR CONEXAO TELNET COM LOCALHOST

Shell Input:
```
telnet www.ic.unicamp.br 80
```
Cria conexção telnet com o servidor do site pela porta 80 (HTTP).

Telnet input:
```
host: www.ic.unicamp.br
GET /~reltech/
```
Obtém o html da página com o caminho descrito em `GET`
